"use strict";(self.webpackChunk_grammarly_denali_app=self.webpackChunk_grammarly_denali_app||[]).push([[2485],{30805:(e,t,o)=>{o.d(t,{r:()=>s,h:()=>D});var n,s,r=o(23988),i=o(50659),a=o(86562),c=o(16432),l=o(80074),d=o(6987),u=o(54988),m=o(21216),p=o(95168),h=o(44297),g=o(36840),f=o(34717),y=o(69063);!function(e){e.Mock=class{constructor(){(0,r._)(this,"selected",l.s.create(h.none).view()),(0,r._)(this,"notLater",!1),(0,r._)(this,"changeSelection",g.Yi),(0,r._)(this,"shown",g.Yi),(0,r._)(this,"dismiss",g.Yi),(0,r._)(this,"remind",g.Yi),(0,r._)(this,"submit",(()=>Promise.resolve()))}}}(n||(n={}));class _{get selected(){return this._selectedRole.view()}get notLater(){return this._notLater}changeSelection(e){this._selectedRole.set(h.some(e))}shown(){this._telemetry.gnarSpec.userRolePopupShow(this._telemetry.pageId),this._onAction({type:c.QN.Shown})}dismiss(){this._telemetry.gnarSpec.userRolePopupClick("dismiss",this._telemetry.pageId),this._onAction({type:c.QN.Dismiss}),this._onClose()}remind(){this._telemetry.gnarSpec.userRolePopupClick("later",this._telemetry.pageId),this._onAction({type:c.QN.Later,expire:7*f.ei}),this._onClose()}submit(){return this.selected.pipe(d.n(h.fold((()=>u.w),(e=>m.of(e)))),p.M((e=>{this._telemetry.gnarSpec.userRolePopupClick("done",this._telemetry.pageId,e),this._account.updateUserRole(e).catch((e=>{this._log.error("Cannot update user role",e)})),this._onAction({type:c.QN.Dismiss}),this._onClose()}))).toPromise()}constructor(e,t,o,n,s){(0,r._)(this,"_onAction",void 0),(0,r._)(this,"_onClose",void 0),(0,r._)(this,"_account",void 0),(0,r._)(this,"_telemetry",void 0),(0,r._)(this,"_notLater",void 0),(0,r._)(this,"_selectedRole",void 0),(0,r._)(this,"_log",void 0),this._onAction=e,this._onClose=t,this._account=o,this._telemetry=n,this._notLater=s,this._selectedRole=l.s.create(h.none),this._log=y.Bx.Logging.getLogger("downloadViewModel")}}!function(e){e.userRole={type:c.q3.UserRole},e.premiumTopFeatures=(e,t,o)=>({type:c.q3.PremiumTopFeatures,features:e,selectedFeatureId:t,onClose:o}),e.clientsComparison=e=>({type:c.q3.ClientsComparison,clientsState:e}),e.grammarlyGoOnboardingCarousel=e=>({type:c.q3.GrammarlyGoOnboarding,userRole:e})}(s||(s={}));class D{load(e){switch(e.type){case c.q3.UserRole:return this._loadUserRole(e.notLater);case c.q3.PremiumTopFeatures:return this._loadPremiumTopFeatures(e);case c.q3.ClientsComparison:return this._loadClientsComparison(e.clientsState);case c.q3.GrammarlyGoOnboarding:return this._loadGrammarlyGoOnboardingCarousel(e.userRole);default:return(0,a.xb)(e)}}_loadPremiumTopFeatures(e){return e.features.forEach((e=>{(new Image).src=e.img})),Promise.all([o.e(2688),o.e(3641),o.e(6671),o.e(1805)]).then(o.bind(o,41658)).then((({TopFeaturesDialog:t})=>o=>({instance:e,component:i.createElement(t,{selectedFeature:e.selectedFeatureId,features:e.features,onClose:()=>{e.onClose(),o.onClose()}})})))}_loadUserRole(e){return Promise.all([o.e(2688),o.e(3641),o.e(6671),o.e(5637),o.e(7763)]).then(o.bind(o,62693)).then((({UserRolePopup:t})=>o=>{const n=new _((e=>this._modals.dispatch(c.q3.UserRole,e)),(()=>o.onClose()),this._account,this._telemetry,this._modals.notLater(c.q3.UserRole));return{instance:{type:c.q3.UserRole,notLater:e},component:i.createElement(t,{model:n})}}))}_loadClientsComparison(e){return Promise.all([o.e(2688),o.e(3641),o.e(6671),o.e(9810),o.e(2552),o.e(1437)]).then(o.bind(o,42037)).then((({ClientsComparisonModal:t})=>o=>({instance:{type:c.q3.ClientsComparison,clientsState:e},component:i.createElement(t,{clientsState:e,modalOperations:o})})))}_loadGrammarlyGoOnboardingCarousel(e){return Promise.all([o.e(2688),o.e(3641),o.e(6671),o.e(2534)]).then(o.bind(o,66662)).then((({GrammarlyGoOnboardingCarousel:t})=>o=>({instance:{type:c.q3.GrammarlyGoOnboarding,userRole:e},component:i.createElement(t,{modalOperations:o,userRole:e})})))}constructor(e,t,o){(0,r._)(this,"_modals",void 0),(0,r._)(this,"_account",void 0),(0,r._)(this,"_telemetry",void 0),this._modals=e,this._account=t,this._telemetry=o}}},74698:(e,t,o)=>{o.d(t,{b:()=>n});var n,s=o(57797),r=o(93629),i=o(30040),a=o(5692),c=o(86562),l=o(44297),d=o(22835),u=o(34717),m=o(36257);!function(e){let t;e.empty={kind:"loading"},e.isOK=e=>"OK"===e.kind,e.fromAsync=e=>{switch(e.status){case a.j.Status.ok:return{kind:"OK",searchResults:e.value};case a.j.Status.error:case a.j.Status.idle:case a.j.Status.inProgress:return{kind:"loading"};case a.j.Status.fatal:return{kind:"error"};default:return(0,c.xb)(e)}},function(e){e.empty=()=>[],e.fromArray=e=>(0,i.flow)(s.pb((e=>Boolean(e.title)||Boolean(e.firstContent))),r._S,l.map(r.$z((e=>{switch(o(e)){case 0:return m.j.Group.todayDocs;case 1:return m.j.Group.yesterdayDocs;default:return m.j.Group.earlierDocs}}))),l.map((o=>d.HP(o).reduce(((t,n)=>(t.push(...o[n].map(((t,s)=>{switch(n){case m.j.Group.todayDocs:case m.j.Group.yesterdayDocs:return m.j.WithDocument.create(e)(t,0===s?l.some(n):l.none);default:return m.j.WithDocument.create(e)(t,(0,i.pipe)(l.fromNullable(o[m.j.Group.todayDocs]),l.alt((()=>l.fromNullable(o[m.j.Group.yesterdayDocs]))),l.filter((()=>0===s)),l.map((()=>n))))}}))),t)),[...t.empty()]))),l.getOrElse((()=>[])));const o=({updatedAt:e})=>{const t=Math.floor((Date.now()-Date.parse(Boolean(e)?e.toString():"0"))/u.ei);return t<0?0:t}}(t=e.Collection||(e.Collection={}))}(n||(n={}))},29518:(e,t,o)=>{o.d(t,{C:()=>n});var n,s=o(83293),r=o(30040),i=o(80074),a=o(5692),c=o(80837),l=o(78339),d=o(6987),u=o(15491),m=o(95168),p=o(36094),h=o(24946),g=o(82718),f=o(89769),y=o(68594),_=o(19711),D=o(21216),P=o(58193),C=o(44297),w=o(81870),v=o(74698),b=o(36644),T=o(62279);!function(e){e.create=(e,t)=>{const o=new c.y.Keeper,n=i.s.create(v.b.empty);return o.push(e.isReady.pipe(l.p(Boolean),d.n((()=>e.documentsPage.list.searchResults.pipe(u.T(v.b.fromAsync),m.M(p.H9(n)))))).subscribe()),{state:n,reset:()=>e.documentsPage.list.reset(),searchText:()=>e.documentsPage.list.searchText,isSearching:()=>e.documentsPage.list.isSearching,isFirstTimeLoaded:()=>e.documentsPage.list.isFirstTimeLoaded,loadDocuments:(t,o)=>e.documentsPage.list.searchResults.pipe(l.p((e=>e.status!==a.j.Status.inProgress)),h.s(1),m.M((()=>e.documentsPage.list.load(o,t))),g.K(n),f.Z(v.b.empty)),createDocument:()=>{e.telemetryLegacy.newDocument(),(0,b.Wd)({time:Date.now(),page:"editor",source:"docListNew"});const o=i.s.create(!0),n=t.location.pipe(y.i(1),_.$()).subscribe((()=>o.set(!1)));return e.documentsPage.actions.createDocumentAndNavigate(o).catch().then((e=>n.unsubscribe()))},downloadOriginalDocument:t=>e.documentsPage.actions.downloadOriginal(t),downloadProofreadDocument:t=>e.documentsPage.actions.downloadProofread(t),downloadProofreadByQuery:()=>(0,r.pipe)(t.query.get("downloadProofread"),P.Mi((()=>n.set({kind:"loading"}))),C.map((t=>e.documentsPage.actions.downloadProofread(t,e.editorTsNotifications.create.downloadProofread(),!0))),C.alt((()=>(0,r.pipe)(t.query.get("downloadOriginal"),P.Mi((()=>n.set({kind:"loading"}))),C.map((t=>e.documentsPage.actions.downloadOriginal({id:t,rtfMode:T.jj.l1.FormattingMode.compatibility})))))),P.Mi((()=>{n.set(v.b.fromAsync(e.documentsPage.list.searchResults.get())),t.replace(w.Lz.routes.documents.href(),(0,r.pipe)(t.locationState,C.toUndefined))})),C.getOrElse((()=>Promise.resolve()))),dispose:()=>{o.dispose()}}},e.mock=(e=[],t="")=>({state:i.s.create({kind:"OK",searchResults:e}),reset:r.constVoid,searchText:()=>i.s.create(t),isSearching:()=>i.s.create(!1),isFirstTimeLoaded:()=>i.s.create(!1),loadDocuments:(0,r.constant)(D.of(v.b.empty)),createDocument:s.of(void 0),downloadOriginalDocument:s.of(void 0),downloadProofreadDocument:s.of(void 0),downloadProofreadByQuery:s.of(void 0),dispose:r.constVoid})}(n||(n={}))},97091:(e,t,o)=>{o.d(t,{W:()=>n});var n,s=o(30040),r=o(80074),i=o(80837),a=o(19711),c=o(95168),l=o(78339),d=o(6987),u=o(60269),m=o(88423),p=o(65621),h=o(15491),g=o(42543),f=o(44297),y=o(58193),_=o(36840),D=o(81870),P=o(62279),C=o(40884);!function(e){e.create=(e,t)=>{const o=new i.y.Keeper,n=e=>e===D.Lz.routes.documents.route.path||e===D.Lz.routes.trash.route.path,r=(0,_.Bj)((()=>new P.ru.mV(e.documentsPage.proofit.cancelled,(t=>e.documentsPage.actions.navigateToDocument(t)))));return o.push(e.isReady.pipe(l.p(Boolean),d.n((()=>u.h(e.userAccount.profile.pipe(a.$(),c.M((o=>{(0,s.pipe)(t.locationState,f.filter((e=>Boolean(e.proofitSubmitted))),y.Mi((()=>{e.editorTsNotifications.show(e.editorTsNotifications.create.proofitInProgress(o.email)),t.replace(D.Lz.routes.documents.href())})))}))),e.userAccount.features.proofit.pipe(c.M((o=>o===C.Fh.enabled?n(t.location.get().pathname)?e.documentsPage.proofit.init():s.constVoid:e.documentsPage.proofit.reset())))))),m.j((()=>{e.userAccount.features.proofit.get()===C.Fh.enabled&&e.documentsPage.proofit.reset()}))).subscribe()),o.push(t.location.pipe(p.J(),h.T((([t,o])=>{const s=n(o.pathname),r=n(t.pathname);s&&r||(s?e.documentsPage.proofit.init():r&&e.documentsPage.proofit.reset())}))).subscribe()),{getCancelledBanner:r,getDocumentProofitResults:t=>e.documentsPage.proofit.results.view(t).view(f.fromNullable),dispose:()=>o.dispose()}},e.mock=()=>({getCancelledBanner:()=>new P.ru.mV(new g.B7,s.constVoid),getDocumentProofitResults:()=>r.s.create(f.none),dispose:s.constVoid})}(n||(n={}))},6614:(e,t,o)=>{o.d(t,{c:()=>s});var n,s,r=o(83531),i=o(83293),a=o(31784),c=o(30040),l=o(11924),d=o(60246),u=o(21662),m=o(15491),p=o(90405),h=o(6987),g=o(38427),f=o(29052),y=o(10047),_=o(36840),D=o(81870);!function(e){e.undoDeleteDocument="undoDeleteDocument"}(n||(n={})),function(e){e.create=(e,t)=>{const o=new d.m(1),s=n=>s=>(e.telemetry.gnarSpec.recoverDocumentButtonClick(e.telemetry.pageId),(0,c.pipe)(e.documentsPage.actions.restoreDocument(s),i.map((a=>{n&&e.editorTsNotifications.show(e.editorTsNotifications.create.documentRestored(s,(0,r._)((function*(){return t.navigate(D.Lz.routes.denali_editor.href({docId:s}))})),(()=>(0,c.pipe)(e.documentsPage.actions.restoreDocument(s),i.map((e=>o.next(e))))()),o)),o.next(a)})))());return{deleteDocument:(t,n)=>{const r=e.editorTsNotifications.show(e.editorTsNotifications.create.documentDeleted(t,n,(()=>s(!1)(t)),o));return e.telemetry.gnarSpec.deleteDocumentButtonClick(t.toString(),e.telemetry.pageId),e.documentsPage.actions.deleteDocument(t).catch((t=>{r&&e.editorTsNotifications.hide(r),e.documentsPage.actions.handleDeleteDocumentError(t)}))},forceDeleteDocument:(t,o)=>{e.telemetry.gnarSpec.deleteForeverButtonClick("oneDocumentDeletion",e.telemetry.pageId);const n=e.editorTsNotifications.show(e.editorTsNotifications.create.deleteForeverPrompt((()=>e.telemetry.gnarSpec.deleteForeverConfirmationDeclineButtonClick("oneDocumentDeletion",e.telemetry.pageId)),(()=>(e.telemetry.gnarSpec.deleteForeverConfirmationConfirmButtonClick("oneDocumentDeletion",e.telemetry.pageId),e.editorTsNotifications.hide(n),e.documentsPage.actions.deleteDocument(t).catch((t=>{e.documentsPage.actions.handleDeleteDocumentError(t)}))))))},emptyTrash:()=>{e.telemetry.gnarSpec.deleteForeverButtonClick("allDocumentsDeletion",e.telemetry.pageId);const t=e.editorTsNotifications.show(e.editorTsNotifications.create.emptyBinPrompt((()=>e.telemetry.gnarSpec.deleteForeverConfirmationDeclineButtonClick("allDocumentsDeletion",e.telemetry.pageId)),(()=>(e.telemetry.gnarSpec.deleteForeverConfirmationConfirmButtonClick("allDocumentsDeletion",e.telemetry.pageId),e.editorTsNotifications.hide(t),e.documentsPage.actions.emptyBin().catch((t=>{e.documentsPage.actions.handleEmptyBinError(t)}))))))},restoreDocument:s,restoreAndOpenDocument:o=>{e.editorTsNotifications.show(e.editorTsNotifications.create.restoreAndOpen((()=>(e.telemetry.gnarSpec.recoverDocumentButtonClick(e.telemetry.pageId),(0,c.pipe)(e.documentsPage.actions.restoreDocument(o),f.Tj((e=>t.navigate(D.Lz.routes.denali_editor.href({docId:e})))),f.WL((t=>i.of(e.documentsPage.actions.handleRestoreError(t)))))()))))},getBindings:o=>[{action:n.undoDeleteDocument,hotkey:o({modifiers:new Set([l.l.short]),key:"z"}),bind:(0,c.flow)(u.E(e.documentsPage.list.deletedDocumentIds.view("soft")),m.T((0,c.flow)(a.gp,y.HV)),p.oE,h.n(s(!1))),isActive:g.zV([e.documentsPage.list.deletedDocumentIds.view("soft").pipe(m.T(y.J_)),t.isActive(D.Lz.routes.documents.href())]).pipe(m.T((0,c.tupled)(_.Uo)))}]}},e.mock=()=>({deleteDocument:i.of(void 0),forceDeleteDocument:c.constVoid,emptyTrash:c.constVoid,restoreDocument:(0,c.constant)(i.of(void 0)),restoreAndOpenDocument:i.of(void 0),getBindings:()=>[]})}(s||(s={}))},70932:(e,t,o)=>{o.d(t,{l:()=>l});var n=o(50659),s=o(20408),r=o(69063),i=o(74056),a=o(93712),c=o(12416);const l=()=>{const e=(0,i.W$)(new a.Qt).base.error500page,t=n.useContext(s._.Context),o=e.description(t.support.troubleshooting.diagnosticTestPath,t.support.troubleshooting.somethingWentWrong);return r.Bx.TimeSeries.rootFemetrics.getMetric("error").getCounter("500").increment(),n.createElement(c.M,{title:e.title,description:o})}}}]);